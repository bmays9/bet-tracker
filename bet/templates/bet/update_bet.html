{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}

<!-- content starts here -->

<div class="container mt-5">
    <div class="row">
        <div class="text-center">
            <h2> Update bet</h2>
        </div>
    <div class="row">
        <div class="col-12 col-md-12 text-center">
        
        {% if user.is_authenticated %}
        <form id="updateBet" method="post">
            {% csrf_token %}
            {{ edit_bet_form | crispy }}
            
            {{ line_formset.management_form }}
            {% for form in line_formset %}
            <div class="line-item">
                {{ form | crispy }}
            </div>
            {% endfor %}

            <button id="submitUpdateBet" type="submit" class="btn btn-primary">Save Changes</button>
        </form>    
        {% else %}
        <p>Please log in to edit your bet </p>
        
        {% endif %}
        
        {% if edit_bet_form.errors %}
        <div class="errors">
            {{ edit_bet_form.errors }}
        </div>
        {% endif %}

        {% for form in line_formset %}
            {% if form.errors %}
            <div class="errors">
                {{ edit_bet_form.errors }}
            </div>
            {% endif %}
        {% endfor %}
   
<!-- content ends here -->

<!-- Modal for edit confirmation message -->
<div class="modal" id="updateConfModal" tabindex="-1" data-show="{% if success %}true{% else %}false{% endif %}" aria-labelledby="updateConfModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Update Successful</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>The changes to your bet have been saved. Click 'Close' to return to the homepage.

          </p>
        </div>
        <div class="modal-footer">
          <button type="button" id="confirmRedirectButton" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}

{% block additional %}
<script src="{% static 'js/editbet.js' %}"></script>
{% endblock %}